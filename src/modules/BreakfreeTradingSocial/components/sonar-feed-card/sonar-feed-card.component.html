<div class="sonar-card" #cardContainer>
    <div class="card-header">
        <div class="card-header-description">
            <div class="favorite-icon hidden" (click)="favorite()">
                <i class="fa fa-star" *ngIf="isFavorite; else notFavorite" aria-hidden="true"></i>
                <ng-template #notFavorite>
                    <i class="fa fa-star-o" aria-hidden="true"></i>
                </ng-template>
            </div>
            <div class="card-header-title">
                <div class="card-header-setup" [ngClass]="{'setup-long': side == 'Long', 'setup-short': side == 'Short'}">
                    <i class="fa" [ngClass]="{'fas fa-arrow-up': side == 'Long', 'fas fa-arrow-down': side == 'Short'}"></i>
                    {{side}}
                </div>
                <div class="hidden"> {{setup}}</div> 
                   
                <div class="card-header-symbol"> {{symbol}}</div>   

                    <div class="card-header-timeframe hidden">{{timeFrame}}</div>  
                    
                
                <div class="card-header-timestamp">
                    {{createTimeString(time)}}
                </div>
            </div>
        </div>
       
    </div>
    <div class="card-chart" #chartContainer [ngClass]="{'chart-selected': selected}" (click)="clickOnChart()">
        <sonar-chart [selected]="selected" [instrument]="instrument" [time]="time" [granularity]="granularity" [isVisible]="isVisible">
        </sonar-chart>
    </div>
    <div class="card-footer">
        <div class="card-footer-buttons">
            <div class="card-footer-view-button" (click)="viewOnChart()">
                View chart
            </div>
            <div class="card-footer-like-button">
                <div class="like-container" (click)="like()">
                    <i class="fa fa-thumbs-up" aria-hidden="true" *ngIf="hasMyLike; else nonActiveLike"></i>
                    <ng-template #nonActiveLike>
                        <i class="fa fa-thumbs-o-up" aria-hidden="true"></i>
                    </ng-template>
                    <!-- <span class="like-counter">{{likeCount}}</span> -->
                </div>
                <div class="rate-count">
                    {{likeCount - dislikeCount}}
                </div>
                <div class="dislike-container" (click)="dislike()">
                    <i class="fa fa-thumbs-down" aria-hidden="true" *ngIf="hasMyDislike; else nonActiveDislike"></i>
                    <ng-template #nonActiveDislike>
                        <i class="fa fa-thumbs-o-down" aria-hidden="true"></i>
                    </ng-template>
                    <!-- <span class="dislike-counter">{{dislikeCount}}</span> -->
                </div>
            </div>
            <div class="card-footer-share-button" (click)="share()">
                Share
            </div>
        </div>
    </div>
    <div class="card-comments" #scroll [ngClass]="{'limit-comments': !showAllCommentsOnExpand}">
        <div class="show-all-comments" *ngIf="commentsTotal > 1 && comments.length <= 1" (click)="showAllComment()">
            View all {{commentsTotal}} comments
        </div>
        <div class="comment-row" *ngFor="let c of comments" [ngClass]="{'own-comment': c.isOwnComment}">
            <sonar-feed-comment [isExpanded]="true" [expandedComments]="expandedComments" [comment]="c" 
            (onExpandComment)="expandComment($event)" (onCommentLike)="likeComment($event)" (onCommentDislike)="dislikeComment($event)" 
            (onAddReplay)="replay($event)" (onRemoveComment)="removeComment($event)" (onEditComment)="editComment($event)"></sonar-feed-comment>
        </div>
        <div class="hide-all-comments" *ngIf="commentsTotal > 1 && comments.length > 1" (click)="hideAllComment()">
            Hide comments
        </div>
    </div>
    <div class="card-left-comment">
        <div class="replay-description" *ngIf="replayComment">
            <div class="replay-comment-text">
                {{replayComment.text}}
            </div>
            <div class="replay-comment-close">
                <i class="crypto-icon crypto-icon-close" (click)="stopReplay()"></i>
            </div>
        </div>
        <!-- <mat-form-field class="crypto-input bft-form-input full-width"> -->
        <div class="card-left-comment-input">
            <textarea class="crypto-textarea nborder comment-textarea" placeholder="Write a public comment..."
                [(ngModel)]="comment" #textarea (keyup)="keyUpOnTextArea($event)"></textarea>
            <div class="send-button" [ngClass]="{'disabled': !comment || comment.length === 0}" (click)="sendComment()">
                Send
            </div>
        </div>
        <!-- </mat-form-field> -->
    </div>
</div>